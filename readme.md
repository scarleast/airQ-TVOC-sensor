# 先来两张完成的图镇楼

斜着来一张

![WechatIMG6](/Users/scarleast/Desktop/WechatIMG6.jpeg)]

正面再来一张

![WechatIMG8](/Users/scarleast/Desktop/WechatIMG8.jpeg)

# 起源

我是一名面向google的码农，曾经想改变世界，后来发现为了生存，在城市里打拼，世界没改变，只博得一个租来的鸽子笼。后来有一天，被北方雾霾的恐惧支配之后，我买了一台空气净化器，虽说可以看得到PM2.5，但除了PM2.5，空气中其他的污染物什么情况，我并不清楚。什么某某品牌车主因车内笨超标得病；某某租房平台，租给租客的房子甲醛超标，导致其得病的消息非常多。

想想，我也有家人，有的刚提新车，有的刚装修新房，有的公司搬刚装修的新址，大家知道空气中我们吸入的是一些什么东西吗？于是我在淘宝搜了一下TVOC传感器，结果如下：

![屏幕快照 2019-08-03 上午11.13.35](/Users/scarleast/Desktop/屏幕快照 2019-08-03 上午11.13.35.png)

发现稍微好点的，大都300元左右左右，并且这种检测模式吧，我也不可能上班天天哪个这玩意儿按呀？我便有了一个念头。

# 需求

我希望自己做一个检测仪出来，它能满足一下条件：

- 能够直观反映空气中苯、甲醛等有害物质的含量，保证结果具备可参考的价值。
- 体积足够的小巧，不能说有多高的颜值，起码不像淘宝上搜到的，都是一大坨吧，摆放在桌上起码得不占地方吧。
- 即插即用。放办公桌，放家里，放车上，总之插上电，稍作等待，即可看到实时传感器芯片测得的读数。工作之余、开车休息之余瞟一眼，就知道当前空气的状况。
- 价格足够低，保证能把成本压缩在几十元的范围内。

# 为什么是TVOC

维基百科： **[挥发性有机物](https://zh.wikipedia.org/zh/挥发性有机物)**（英语：Volatile Organic Compounds，[首字母缩略字](https://zh.wikipedia.org/wiki/首字母縮略字)：VOCs），有时也用TVOC来表示( 英语：Total Volatile Organic Compound )。

实际上，TVOC，就指的是空气中所有挥发性有机物的总量，那什么是挥发性有机物呢？常见的笨、甲醛等，都属于挥发性有机物。我不可能想起来苯，就去买个苯的检测仪，想起来甲醛，就去买个甲醛的检测仪，当然，不差钱另说。所以用TVOC检测仪，一次性检测一下空气中所有挥发性有机物的含量，就能大致推断出当前空气的质量。如果TVOC值过高，则说明空气确实有一定的问题，就需要找专业的检测机构做相关的检测了。那么TVOC的标准是多少呢？见下表：

![屏幕快照 2019-04-28 上午12.17.00](/Users/scarleast/Desktop/屏幕快照 2019-04-28 上午12.17.00.png)

# 芯片选型

## 传感器芯片

由于限定了我想做的这款传感器的价格，总成本在100元之内，翻遍了淘宝，最终确定了一款芯片，[ccs811](https://ams.com/ccs811)。这款芯片由[ams](https://ams.com/zh/about-ams)公司出品，虽然不是崇洋媚外，但传感器这种东西还是需要积累的，这样一家老牌的传感器解决方案厂商的芯片，质量应该可是可靠的。

## 主控芯片

这一点就没啥好说的，直接上STM32，F103用的最熟，哪个便宜选哪个，所以最终选择了STM32F103C8T6。

# 成本

因为电阻、电容之类的很难计算每个板子的成本，加上快递之类的，这里只是给出一个大致的价格。

| 分类                        | 价格(元) |
| --------------------------- | -------- |
| CCS811                      | 50       |
| STM32F103C8T6               | 8        |
| OLED显示屏                  | 13       |
| 电阻、LED、电容、usb接口等  | 10       |
| PCB打样                     | 6        |
| 亚克力外壳                  | 2        |
| 队友手焊贴片请奶茶（23333） | 10       |
| 总价                        | 99       |

# 目录结构

- 软件
  - STM32的代码
- 文档
  - 原理图及元件清单
  - CCS811数据手册
- 硬件
  - 板子

# 暂时发现的问题

1. 这款传感器实际检测空气中的碳的含量，所以TVOC和eCO2都是计算出来的，不会非常精准，结果仅供参考。另外，人一吹气，变动较大，变动大的时候，停止呼吸？
2. 传感器未带风扇，由于空气有流通性，所以想快速检测的时候，张牙舞爪，致命shake一波？
3. MCU检测到传感器掉线或者异常，会重新初始化传感器，无大碍，但确实这款传感器不是很好用。
4. 传感器需要预热，通常实际测试，10-20分钟左右（预热时间还是比较长），读数才会稳定。
5. 队友手焊贴片，难受啊，马飞。

# 最后还想说两句

目前自己做的这款TVOC传感器算是开源出来了吧，说复杂不复杂，说简单不简单的小玩意儿，有小伙伴说求教程，但是很难一行一行说代码如何实现的，感兴趣的小伙伴自己看看吧，不是多复杂的程序。

打样之类的，都是5片起做，所以除了自己留了一块用，还剩下4块传感器，懒得动手的小伙伴，可以私信一波我呀，我们闲鱼一波，99块，只想回血一波请队友奶茶的钱~贫困线奔波的孩子，开不起淘宝店。

![WechatIMG11](/Users/scarleast/Desktop/WechatIMG11.jpeg)

和我的树莓派放在一起，大家可以直观的看出来大小。